<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Register</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    body {
      background: url('/images/loginn-bg-img.jpg') no-repeat center center fixed;
      background-size: cover;
      font-family: 'Segoe UI', sans-serif;
    }
    .register_card_img {
      flex: 3;
      object-fit: cover;
      background: url('/images/login_page_img.png') no-repeat center center;
      background-size: cover;
    }
    .register-wrapper {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(4px);
      padding: 20px;
    }
    .register-container {
      display: flex;
      width: 900px;
      max-width: 96%;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0px 6px 30px rgba(0,0,0,0.35);
      background: rgba(255, 255, 255, 0.55);
      backdrop-filter: blur(12px);
      animation: fadeIn 0.8s ease-in-out;
    }
    .register-card { flex: 2; padding: 35px; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .register-card h2 { text-align: center; margin-bottom: 15px; color: black; }
    .register-card p { text-align: center; font-size: 14px; color: #333; margin-bottom: 25px; }
    .input-group { position: relative; margin-bottom: 20px; }
    .input-group input { padding-right: 40px; padding-left: 15px; border-radius: 8px; }
    .input-group .input-icon {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #555;
      cursor: pointer;
      z-index: 5;
    }
    .input-group .input-icon:hover { color: #e91e63; transform: translateY(-50%) scale(1.06); }
    .form-control {
      border-radius: 10px !important;
      padding: 12px 15px 12px 50px;
      border: 1px solid #ddd;
      background: rgba(255,255,255,0.9);
      transition: all 0.3s ease;
    }
    .form-control:focus { border-color: #ff934b; box-shadow: 0 0 8px rgba(220,90,80,0.2); background: #fff; }
    .btn-register {
      width: 100%;
      border-radius: 10px;
      padding: 11px 14px;
      background: linear-gradient(135deg, #0cc5b7 0%, #2bd891 100%);
      border: none;
      color: #fff;
      font-weight: 600;
      box-shadow: 0 6px 18px rgba(120,115,245,0.18);
      transition: all 0.25s ease;
    }
    .btn-register:hover { filter: brightness(.96); }
    .form-check-label { font-size: 14px; color: #333; }
    .register-card .small-link { font-size: 14px; color: #0d6efd; text-decoration: none; }
    .register-card .small-link:hover { text-decoration: underline; }
    .error-msg { color: red; font-size: 13px; margin-top: -15px; margin-bottom: 10px; display: none; }
  </style>
</head>

<body>
  <div class="register-wrapper">
    <div class="register-container">
      <!-- Left Side Image -->
      <div class="register_card_img"></div>
      <!-- Right Side Form -->
      <div class="register-card pt-4">
        <h2><b>Create Account</b></h2>
        <form th:action="@{/user/saveUser}" th:object="${user}" method="post" autocomplete="off" id="registerForm">
          <!-- Full Name -->
          <div class="input-group mb-3">
            <input type="text" th:field="*{userName}" class="form-control form-control-sm" placeholder="Full name" required autocomplete="off">
            <i class="bi bi-person input-icon"></i>
          </div>

          <!-- Mobile -->
          <div class="input-group mb-3">
            <input type="text" th:field="*{mobile}" class="form-control form-control-sm" placeholder="Mobile number" required autocomplete="off" maxlength="10" id="mobileInput">
            <i class="bi bi-telephone input-icon"></i>
          </div>
          <div class="error-msg" id="mobileError"></div>

          <!-- Address -->
          <div class="input-group mb-3">
            <input type="text" th:field="*{address}" class="form-control form-control-sm" placeholder="Address" autocomplete="off">
            <i class="bi bi-geo-alt input-icon"></i>
          </div>

          <!-- Pincode -->
          <div class="input-group mb-3">
            <input type="text" th:field="*{pincode}" class="form-control form-control-sm" placeholder="Pincode" autocomplete="off">
            <i class="bi bi-pin input-icon"></i>
          </div>

          <!-- Password -->
          <div class="input-group mb-3">
            <input type="password" id="password" th:field="*{password}" class="form-control form-control-sm" placeholder="Password" required autocomplete="new-password">
            <i class="bi bi-eye input-icon" id="togglePassword"></i>
          </div>

          <div class="mb-3 d-flex justify-content-between align-items-center">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="terms" required>
              <label class="form-check-label" for="terms">I agree to the Terms</label>
            </div>
            <a href="/user/login" class="small-link">Already have an account?</a>
          </div>

          <button type="submit" class="btn btn-register">REGISTER</button>
        </form>
      </div>
    </div>
  </div>

  <script>
    // Toggle password visibility
    const togglePassword = document.querySelector("#togglePassword");
    const password = document.querySelector("#password");
    togglePassword.addEventListener("click", function () {
      const type = password.getAttribute("type") === "password" ? "text" : "password";
      password.setAttribute("type", type);
      this.classList.toggle("bi-eye");
      this.classList.toggle("bi-eye-slash");
    });

    // Mobile validation
    const mobileInput = document.getElementById("mobileInput");
    const mobileError = document.getElementById("mobileError");
    const form = document.getElementById("registerForm");

    mobileInput.addEventListener("input", function() {
      const value = mobileInput.value.trim();

      if (/[^0-9]/.test(value)) {
        mobileError.textContent = "Only numbers are allowed.";
        mobileError.style.display = "block";
      } else if (value.length > 0 && !/^[6-9]/.test(value)) {
        mobileError.textContent = "Mobile number must start with 6, 7, 8, or 9.";
        mobileError.style.display = "block";
      } else if (value.length > 0 && value.length < 10) {
        mobileError.textContent = "Mobile number must be exactly 10 digits.";
        mobileError.style.display = "block";
      } else if (value.length === 10 && /^[6-9][0-9]{9}$/.test(value)) {
        mobileError.style.display = "none";
      } else {
        mobileError.style.display = "none";
      }
    });

    form.addEventListener("submit", function(e) {
      const mobile = mobileInput.value.trim();
      if (!/^[6-9][0-9]{9}$/.test(mobile)) {
        e.preventDefault();
        if (!/^[6-9]/.test(mobile)) {
          mobileError.textContent = "Mobile number must start with 6, 7, 8, or 9.";
        } else if (mobile.length !== 10) {
          mobileError.textContent = "Mobile number must be exactly 10 digits.";
        } else {
          mobileError.textContent = "Invalid mobile number.";
        }
        mobileError.style.display = "block";
        mobileInput.focus();
      }
    });
  </script>
</body>
</html>
